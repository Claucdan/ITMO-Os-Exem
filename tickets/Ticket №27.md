# Страничная организация виртуальной памяти. Вычисление физических адресов при страничной организации виртуальной памяти.
![](../img/Pasted%20image%2020250623133115.png)
## Страничная организация виртуальной памяти
Метод управления памятью, при котором виртуальное адресное пространство процесса делится на фиксированные по размеру блоки, называемые **страницами**. Аналогично, физическая память делится на блоки того же размера, называемые **фреймами**. Каждая страница может быть размещена в любом свободном фрейме физической памяти или на диске (в разделе подкачки).
## Ключевые компоненты:
### Таблица страниц
Каждый процесс имеет свою таблицу страниц, которая хранит информацию о соответствии виртуальных страниц физическим фреймам или их расположении на диске. Каждая запись в таблице страниц содержит:
- Бит **M** (присутствия): указывает, находится ли страница в оперативной памяти (1) или на диске (0).
- Бит **A** (доступа): устанавливается в 1 при обращении к странице.
- Бит **W** (изменения): указывает, была ли страница изменена.
- Физический адрес фрейма (если страница в памяти) или адрес на диске (если страница в swap).
### Размер страницы
Обычно составляет 1, 2 или 4 Кб. Например, для 4 Кб страницы:
- Виртуальный адрес делится на:
	- Старшие биты (например, 20 бит для 32-битной системы) — номер страницы.
	- Младшие биты (12 бит) — смещение внутри страницы.
## Вычисление физического адреса
### Разделение виртуального адреса**:
- Виртуальный адрес делится на две части:
	- **Номер страницы (Page Number)**: Определяет запись в таблице страниц.
	- **Смещение (Offset)**: Определяет положение внутри страницы/фрейма.
Например, для 32-битного адреса и страницы 4 Кб:
- 20 старших бит — номер страницы.
- 12 младших бит — смещение.
### Поиск в таблице страниц**:
- По номеру страницы находится соответствующая запись в таблице страниц.
- Проверяется бит **M**:
	- Если **M = 1**, страница находится в оперативной памяти. Физический адрес фрейма извлекается из записи.
	- Если **M = 0**, возникает **страничное прерывание (page fault)**. ОС загружает страницу с диска в свободный фрейм, обновляет таблицу страниц и повторяет операцию.
### Формирование физического адреса**:
- Физический адрес = (адрес фрейма) × (размер страницы) + смещение.
- Например, если фрейм имеет номер 5, а смещение 100:
    - Физический адрес = 5 × 4096 + 100 = 20580.
## Иерархическая таблица страниц
Для уменьшения размера таблицы страниц используется иерархическая структура:
- **Каталог таблиц страниц**: Содержит адреса участков таблицы страниц.
- **Участки таблицы страниц**: Содержат записи о страницах.
- Преобразование адреса требует дополнительных шагов, но экономит память.